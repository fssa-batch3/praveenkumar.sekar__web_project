<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale1.0">
    <meta name="viewport" content="width=device-width, initial-scale1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Catamaran:wght@100;200;300;400;500;600;700;800;900&family=Neuton:ital,wght@0,200;0,300;0,400;0,700;0,800;1,400&family=Telex&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../../assets/css/product_detail.css">
    <link rel="stylesheet" href="../../assets/css/header.css">
    <link rel="stylesheet" href="../../assets/css/normalize.css">
    <link rel="stylesheet" href="../../assets/css/footer.css">
    <script src="https://cdn.jsdelivr.net/npm/uuid@8.3.2/dist/umd/uuidv4.min.js"></script>
    <title>Bakery</title>
</head>

<body class="body">
    <!-- <header id ="header">
            <div class="container">
                    <img src="../../assets/Images/v1033-a-15-a-removebg-preview - Copy.svg" width="100px" alt="logo">
                    <nav>
                    <ul>
                        <li><a href="../../index.html">Home</a></li>
                        <li><a href="../products/product_list.html">Products</a></li>
                        <li><a href="../../../Log in and Sign up/Log in.html">Log In</a></li>
                        <li><a href="../../../Cart/cart.html"><img src=".././../assets/Images/icon-cart.svg" alt="cart"></a></li>
                        <li><a href="../../../Profile/profile.html"><img src="../../assets/Images/profile.svg" width="26px" alt="Profile"></a></li>
                    </ul>
                    </nav>
        </header> -->

    <div class="whole">
        <!-- <section class="main">
                <div class="main_img">  
                    <img src="../../assets/Images/Cakes/Banana Salted Caramel.png" width="500px" alt="banana salted caramel">
                </div>
            </section>
            
            <section class="side">
            <div class="side_para">
                    <h1>BANANA SALTED CARAMEL CAKE</h1>
                    <p class="para">This cake has most delicious blend of flavors and textures. Two layers of moist banana cake are topped with a luscious caramel frosting, a sweet and salty caramel sauce, crunchy walnuts and sweet banana slices. The perfect cake for any occasion!
                        That salted caramel and banana combination were just meant to be. It creates sweet and rich dessert perfection.</p>
                    <div class="price1">
                        <p> ₹500 </p>
                    </div>
                </div>
                <div class="spec">
                    <h2>WEIGHT</h2>
                    <div class="spec-buttons">
                    <button>1Kg</button>
                    <button>2Kg</button>
                    <button>3Kg</button>
                    </div>
                </div>
                <div>
                    <textarea placeholder="Enter special message here" rows="4" cols="30"></textarea>
                </div>
                <div class="buttons">
                <div class="amount">
                    <button>-0+</button> 
                </div>
                <div class="add">
                    <a href="../../../Cart/cart.html"><button> &#x1F6D2; Add to cart</button></a>
                </div>
            </div>
            </section> -->
    </div>
    <!-- youmay also like -->
    <section class="suggest">
        <div class="like">
            <h1>YOU MAY ALSO LIKE</h1>
        </div>
        <div class="products">
            <a href="../Breads/Country Loaf.html">
                <div class="product">
                    <h2>Country Loaf</h2>
                    <p>₹40</p>
                    <img class="img_size" src="../../assets/Images/Breads/Country-Loaf-removebg-preview.png"
                        height="300px" width="350px" alt="country loaf">
                    <a href="../Breads/Country Loaf.html"><button class="prod_button">Learn more</button></a>
                </div>
            </a>
            <a href="../Cakes/Vanilla Sprinkle.html">
                <div class="product">
                    <h2>Vanila Sprinkle Cake</h2>
                    <p>₹450</p>
                    <img class="img_size" src="../../assets/Images/Cakes/Vanilla Sprinkle.png" height="300px"
                        width="350px" alt="Vanilla Sprinkle">
                    <a href="../Cakes/Vanilla Sprinkle.html"><button class="prod_button">Learn more</button></a>
                </div>
            </a>
            <a href="../Breakfast Pastries/Multigrain Croissant.html">
                <div class="product">
                    <h2>Multigrain Butter Croissant</h2>
                    <p>₹45</p>
                    <img class="img_size"
                        src="../../assets/Images/Breakfast Pastries/Multigrain_Butter_Croissant-removebg-preview.png"
                        height="300px" width="350px" alt="multigrain butter croissant">
                    <a href="../Breakfast Pastries/Multigrain Croissant.html"><button class="prod_button">Learn
                            more</button></a>
                </div>
        </div>
    </section>
    <footer>
        <div class="foot">
            <h1>HOME BAKERY</h1>
            <div class="list">
                <ul>
                    <li>
                        <h2>ABOUT</h2>
                    </li>
                    <li><a href="../../../../index.html">Homepage</a></li>
                    <li><a href="../../../../index.html#about">About Us</a></li>
                    <li><a href="../../../../index.html#history">Our History</a></li>
                    <li><a href="../../../products/product_list.html">Products</a></li>
                </ul>
                <ul>
                    <li>
                        <h2>PRODUCTS</h2>
                    </li>
                    <li><a href="../../../products/product_list.html">Breads</a></li>
                    <li><a href="../../../products/product_list.html">Cakes</a></li>
                    <li><a href="../../../products/product_list.html">Breakfast Pastries</a></li>
                </ul>
                <ul>
                    <li>
                        <h2>FOLLOW US</h2>
                    </li>
                    <a href="https://www.instagram.com/">
                        <li><img src="../../../../assets/Images/instagram.svg" width="40px" alt="instagram">Instagram
                        </li>
                    </a>
                    <a href="https://twitter.com/">
                        <li><img src="../../../../assets/Images/twitter.svg" width="40px" alt="twitter">Twitter</li>
                    </a>
                    <a href="https://github.com/">
                        <li><img src="../../../../assets/Images/github.svg" width="40px" alt="GitHub">GitHub</li>
                    </a>
                </ul>
            </div>
        </div>

    </footer>

    <script src="../../assets/header.js"></script>

    <script>
        //                             const prod_details = [

        // // CAKES
        //     {
        //         "name": "Banana Salted Caramel",
        //         "price":{
        //             "currency" : "₹",
        //             "value" : "500"
        //         },
        //         "image":{
        //             "src": "../../assets/Images/Cakes/Banana Salted Caramel.png",
        //             "alt": "Salted Banana Caramel Cake"},
        //         "category": "cake"
        //     },

        //     {
        //         "name": "Vanilla Sprinkle Cake",
        //         "price":{
        //             "currency" : "₹",
        //             "value" : "450"
        //         },
        //         "image":{
        //             "src": "../../assets/Images/Cakes/Vanilla Sprinkle.png",
        //             "alt": "Vanilla Sprinkle Cake"},
        //         "category": "cake"
        //     },

        //     {
        //         "name": "Chocolate Raspberry Cake",
        //         "price":{
        //             "currency" : "₹",
        //             "value" : "650"
        //         },
        //         "image":{
        //             "src": "../../assets/Images/Cakes/Chocolate Raspberry.png",
        //             "alt": "Chocolate raspberry cake"},
        //         "category": "cake"
        //     },


        //     {
        //         "name": "Cookies And Cream Cake",
        //         "price":{
        //             "currency" : "₹",
        //             "value" : "600"
        //         },
        //         "image":{
        //             "src": "../../assets/Images/Cakes/Cookies and Cream.png",
        //             "alt": "Cookies and cream cake"},
        //         "category": "cake"
        //     },

        //     {
        //         "name": "Red Velvet",
        //         "price":{
        //             "currency" : "₹",
        //             "value" : "650"
        //         },
        //         "image":{
        //             "src": "../../assets/Images/Cakes/Red velvet.png",
        //             "alt": "Red velvet cake"},
        //         "category": "cake"
        //     },

        //     {

        //         "name": "Carrot Cake",
        //         "price":{
        //             "currency" : "₹",
        //             "value" : "450"
        //         },
        //         "image":{ 
        //             "src": "../../assets/Images/Cakes/Carrot Cake.png",
        //             "alt": "Carrot Cake"},
        //         "category": "cake"
        //     },

        //     // BREADS

        //     {
        //         "name": "Country Loaf",
        //         "price":{
        //             "currency" : "₹",
        //             "value" : "40"
        //         },
        //         "image":{
        //             "src": "../../assets/Images/Breads/Country-Loaf-removebg-preview.png",
        //             "alt": "country loaf"},
        //         "category": "bread"
        //     },

        //     {
        //         "name": "Cereal Bread",
        //         "price":{
        //             "currency" : "₹",
        //             "value" : "50"
        //         },
        //         "image":{
        //             "src": "../../assets/Images/Breads/cereal-bread-removebg-preview.png",
        //             "alt": "cereal bread"},
        //         "category": "bread"
        //     },

        //     {
        //         "name": "Gralic Bread",
        //         "price":{
        //             "currency" : "₹",
        //             "value" : "50"
        //         },
        //         "image":{
        //             "src": "../../assets/Images/Breads/garlic-roll-removebg-preview.png",
        //             "alt": "Garlic Bread"},
        //         "category": "bread"
        //     },

        //     {
        //         "name": "Burger Bun",
        //         "price":{
        //             "currency" : "₹",
        //             "value" : "30"
        //         },
        //         "image":{
        //             "src": "../../assets/Images/Breads/burger-bun-removebg-preview.png",
        //             "alt": "burger bun"},
        //         "category": "bread"
        //     },

        //     {
        //         "name": "Sweet Bread",
        //         "price":{
        //             "currency" : "₹",
        //             "value" : "40"
        //         },
        //         "image":{
        //             "src": "../../assets/Images/Breads/sweet-bread-removebg-preview.png",
        //             "alt": "sweet bread"},
        //         "category": "bread"
        //     },

        //     {

        //         "name": "Wheat Bread",
        //         "price":{
        //             "currency" : "₹",
        //             "value" : "50"
        //         },
        //         "image":{ 
        //             "src": "../../assets/Images/Breads/Wheat-bread-removebg-preview.png",
        //             "alt": "wheat bread"},
        //         "category": "bread"
        //     },


        //     // BREAKFAST PASTRIES
        //     {
        //         "name": "Chocolate Croissant",
        //         "price":{
        //             "currency" : "₹",
        //             "value" : "40"
        //         },
        //         "image":{
        //             "src": "../../assets/Images/Breakfast Pastries/Chocolate_Croissant-removebg-preview.png",
        //             "alt": "chocolate croissant"},
        //         "category": "breakfast pastry"
        //     },

        //     {
        //         "name": "Multigrain Butter Croissant",
        //         "price":{
        //             "currency" : "₹",
        //             "value" : "45"
        //         },
        //         "image":{
        //             "src": "../../assets/Images/Breakfast Pastries/Multigrain_Butter_Croissant-removebg-preview.png",
        //             "alt": "multigrain butter croissant"},
        //         "category": "breakfast pastry"
        //     },

        //     {
        //         "name": "Traditional Croissant",
        //         "price":{
        //             "currency" : "₹",
        //             "value" : "30"
        //         },
        //         "image":{
        //             "src": "../../assets/Images/Breakfast Pastries/Traditional Croissant.png",
        //             "alt": "traditional croissant"},
        //         "category": "breakfast pastry"
        //     },

        //     {
        //         "name": "Sprinkled Cookies",
        //         "price":{
        //             "currency" : "₹",
        //             "value" : "15"
        //         },
        //         "image":{
        //             "src": "../../assets/Images/Breakfast Pastries/sprinkle_thumbnail.png",
        //             "alt": "sprinkled cookies"},
        //         "category": "breakfast pastry"
        //     },

        //     {
        //         "name": "Dark Chocolate Cookies",
        //         "price":{
        //             "currency" : "₹",
        //             "value" : "25"
        //         },
        //         "image":{
        //             "src": "../../assets/Images/Breakfast Pastries/dark_and_white_chocolate_florentine_thumbnail.png",
        //             "alt": "dark chocolate cookies"},
        //         "category": "breakfast pastry"
        //     },

        //     {

        //         "name": "Cheese Croissant",
        //         "price":{
        //             "currency" : "₹",
        //             "value" : "40"
        //         },
        //         "image":{ 
        //             "src": "../../assets/Images/Breakfast Pastries/Cheese croissant.png",
        //             "alt": "cheese croissant"},
        //         "category": "breakfast pastry"
        //     }

        // ]



        let params = window.location.search;
        console.log(params);
        let urlParams = new URLSearchParams(params);

        let product = urlParams.get('product_id');
        console.log(product);

        const prod_details = JSON.parse(localStorage.getItem("prod_detail"));

        function findProduct(e) {
            return e.product_id === product;
        }

        let prod_data = prod_details.find(findProduct);
        console.log(prod_data);

        let price_list = [];

        let size = 0;


        // creating elements

        let find_default_price = prod_data["price_details"].find(e => e.size == 0)
        let find_second_price = prod_data["price_details"].find(e => e.size == 1)
        let find_third_price = prod_data["price_details"].find(e => e.size == 2)

        whole = document.createElement("div");
        whole.setAttribute("class", "whole");
        console.log(whole);

        main = document.createElement("section");
        main.setAttribute("class", "main");
        whole.append(main);

        main_img = document.createElement("div");
        main_img.setAttribute("class", "main_img");
        main.append(main_img);

        prod_img = document.createElement("img");
        prod_img.setAttribute("src", prod_data["image"].src);
        prod_img.setAttribute("alt", prod_data["image"].alt);
        main_img.append(prod_img);

        side = document.createElement("section");
        side.setAttribute("class", "side");
        whole.append(side);

        side_para = document.createElement("div");
        side_para.setAttribute("class", "side_para");
        side.append(side_para);

        side_h1 = document.createElement("h1");
        side_h1.innerText = (prod_data["name"]);
        side_para.append(side_h1);

        side_p = document.createElement("p");
        side_p.innerText = (prod_data["description"]);
        side_para.append(side_p);

        price1 = document.createElement("div");
        price1.setAttribute("class", "price1");
        side_para.append(price1);

        price_p = document.createElement("p");
        price_p.innerText = ("₹" + find_default_price["price"]);
        price1.append(price_p);

        // start 

        if (prod_data["category"] == "Cakes") {
            spec = document.createElement("div");
            spec.setAttribute("class", "spec");
            side.append(spec);

            spec_h2 = document.createElement("h2");
            spec_h2.innerText = ("WEIGHT");
            spec.append(spec_h2);

            spec_button = document.createElement("div");
            spec_button.setAttribute("class", "spec-buttons");
            spec.append(spec_button);

            w_btn1 = document.createElement("button");
            w_btn1.setAttribute("class", "weights");
            w_btn1.setAttribute("onclick", "half_kg()");
            w_btn1.setAttribute("id", "0");
            w_btn1.innerText = ("1/2Kg")
            spec_button.append(w_btn1);

            w_btn2 = document.createElement("button");
            w_btn2.setAttribute("class", "weights");
            w_btn2.setAttribute("onclick", "one_kg()");
            w_btn2.setAttribute("id", "1");
            w_btn2.innerText = ("1Kg")
            spec_button.append(w_btn2);

            w_btn3 = document.createElement("button");
            w_btn3.setAttribute("class", "weights");
            w_btn3.setAttribute("onclick", "two_kg()");
            w_btn3.setAttribute("id", "2");
            w_btn3.innerText = ("2Kg")
            spec_button.append(w_btn3);

            tarea_div = document.createElement("div");
            tarea_div.setAttribute("class", "tarea");
            side.append(tarea_div);

            tarea = document.createElement("textarea");
            tarea.setAttribute("placeholder", "Enter special message here");
            tarea.setAttribute("rows", "4");
            tarea.setAttribute("cols", "30");
            tarea_div.append(tarea);





            function half_kg() {
                document.querySelector(".price1").innerHTML = "";

                price_p = document.createElement("p");
                price_p.innerText = ("₹" + find_default_price["price"]);
                price1.append(price_p);

                let container = document.getElementById("0");

                let test = container.dataset.size;

                let get_price = prod_data["price_details"].find(e => e.size == 0);

                if (price_list.length > 0) {

                    let remove = price_list.shift();

                    price_list.push(get_price);

                }

                else {
                    price_list.push(get_price);
                }

                size = 0;

                console.log(size);

                // console.log(price_list);

            }

            function one_kg() {
                document.querySelector(".price1").innerHTML = "";

                price_p = document.createElement("p");
                price_p.innerText = ("₹" + find_second_price["price"]);
                price1.append(price_p);

                let container = document.getElementById("1");

                let test = container.dataset.size;

                let get_price = prod_data["price_details"].find(e => e.size == 1);

                if (price_list.length > 0) {

                    let remove = price_list.shift();

                    price_list.push(get_price);

                }

                else {
                    price_list.push(get_price);
                }

                size = 1;

                console.log(size);
            }

            function two_kg() {
                document.querySelector(".price1").innerHTML = "";

                price_p = document.createElement("p");
                price_p.innerText = ("₹" + find_third_price["price"]);
                price1.append(price_p);

                let container = document.getElementById("2");

                let test = container.dataset.size;

                let get_price = prod_data["price_details"].find(e => e.size == 2);

                if (price_list.length > 0) {

                    let remove = price_list.shift();

                    price_list.push(get_price);

                }

                else {
                    price_list.push(get_price);
                }


                size = 2;

                console.log(size);

            }


            // let weight = document.querySelectorAll(".weights");

            // weight.forEach(function change_price(change){
            //     change.addEventListener("click", function () {

            //     }
            // )})


        }

        console.log(price_list);

        // end 

        btns = document.createElement("div");
        btns.setAttribute("class", "buttons");
        side.append(btns);

        // btns_amount = document.createElement("div");
        // btns_amount.setAttribute("class", "amount");
        // btns.append(btns_amount);

        // amount_btn = document.createElement("button");
        // amount_btn.innerText = ("-0+")
        // btns_amount.append(amount_btn);

        btns_add = document.createElement("div");
        btns_add.setAttribute("class", "add");
        btns_add.setAttribute("data-id", prod_data["product_id"]);
        btns.append(btns_add);

        add_btn = document.createElement("button");
        add_btn.setAttribute("id", "add");
        add_btn.innerText = ("Add to cart")
        btns_add.append(add_btn);

        document.querySelector("div.whole").append(main);
        document.querySelector("div.whole").append(side);


        let add_item = document.querySelector(".add");

        add_item.addEventListener('click', function (e) {

            let params = window.location.search;
            let urlParams = new URLSearchParams(params);

            let product = urlParams.get('product_id');

            // let cart_id = JSON.parse(localStorage.getItem('cart_id')) || [];

            // cart_id.push(product, size);

            // localStorage.setItem('cart_id', JSON.stringify(cart_id));


            let prod_unique_id = this.dataset.id;

            localStorage.setItem('prod_unique_id', JSON.stringify(prod_unique_id));

            let unique_id = JSON.parse(localStorage.getItem('prod_unique_id'));

            let prod_list = JSON.parse(localStorage.getItem("prod_detail"));

            function findProduct(e) {
                return e.product_id === product;
            }

            prod_data = prod_list.find(findProduct);

            //  console.log(prod_data);

            let prod_size = size;

            let product_size = JSON.parse(localStorage.getItem('prod_size'));

            if (prod_data["category"] == "Cakes"){

            localStorage.setItem('prod_size', JSON.stringify(prod_size));

            }

            let prod_price = price_p.innerText.substr(1);

            console.log(prod_price);

            // console.log(prod_price);

            let cart = JSON.parse(localStorage.getItem('add_to_cart'))
            let user_id = JSON.parse(localStorage.getItem('uniqueID'));

            if (user_id == null) {
                alert("Please login")
            }

            else {

                if (cart == null) {

                    if (prod_data["category"] == "Cakes"){

                    cart = [{
                        "product_cart_id": uuidv4(),
                        "product_name": prod_data["name"],
                        "product_id": prod_data["product_id"],
                        "user_id": user_id,
                        "image": prod_data["image"].src,
                        "product_description": prod_data["product_description"],
                        "size": size,
                        "product_id": prod_unique_id,
                        "quantity": 1,
                        "price": prod_price,
                        "category": prod_data["category"]
                    }];

                    localStorage.setItem("add_to_cart", JSON.stringify(cart));

                    window.alert("Product has been added to cart");

                }

                else {
                    cart = [{
                        "product_cart_id": uuidv4(),
                        "product_name": prod_data["name"],
                        "product_id": prod_data["product_id"],
                        "user_id": user_id,
                        "image": prod_data["image"].src,
                        "product_description": prod_data["product_description"],
                        "size": 0,
                        "product_id": prod_unique_id,
                        "quantity": 1,
                        "price": prod_price,
                        "category": prod_data["category"]
                    }];

                    localStorage.setItem("add_to_cart", JSON.stringify(cart));

                    window.alert("Product has been added to cart");
                }

                }

                else {
                    let cart = JSON.parse(localStorage.getItem("add_to_cart"));
                    let logic = false;

                    if (prod_data["category"] == "Cakes") {
                        for (let i = 0; i < cart.length; i++) {

                            if (unique_id === cart[i]["product_id"] && product_size == cart[i]["size"]) {
                                logic = true;
                            }
                        }
                        if (!logic) {
                        cart.push({
                            "product_cart_id": uuidv4(),
                            "product_name": prod_data["name"],
                            "product_id": prod_data["product_id"],
                            "user_id": user_id,
                            "image": prod_data["image"].src,
                            "product_description": prod_data["product_description"],
                            "size": size,
                            "product_id": prod_unique_id,
                            "quantity": 1,
                            "price": prod_price,
                            "category": prod_data["category"]
                        });

                        localStorage.setItem("add_to_cart", JSON.stringify(cart));

                        window.alert("Product has been added to cart");
                    }

                    }

                    else {
                        for (let i = 0; i < cart.length; i++) {

                            if (unique_id === cart[i]["product_id"]) {
                                logic = true;
                            }
                        }

                        if (!logic) {
                        cart.push({
                            "product_cart_id": uuidv4(),
                            "product_name": prod_data["name"],
                            "product_id": prod_data["product_id"],
                            "user_id": user_id,
                            "image": prod_data["image"].src,
                            "product_description": prod_data["product_description"],
                            "size": 0,
                            "product_id": prod_unique_id,
                            "quantity": 1,
                            "price": prod_price,
                            "category": prod_data["category"]
                        });

                        localStorage.setItem("add_to_cart", JSON.stringify(cart));

                        window.alert("Product has been added to cart");
                    }
                }
                }
            };


        });



    </script>
</body>

</html>